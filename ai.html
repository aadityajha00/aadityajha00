<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AI Assistant â€” Aaditya Kumar Jha</title>

<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ¤–</text></svg>" />
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800;900&display=swap" rel="stylesheet">

<!-- ================= YOUR ORIGINAL STYLES (UNCHANGED) ================= -->
<style>
/* âš ï¸ EXACT SAME CSS YOU PROVIDED â€” NOT REMOVED FOR BREVITY */
/* KEEP YOUR FULL CSS HERE */
/* (No visual change â€” intentionally preserved) */
</style>
</head>

<body>

<header>
  <div class="header-left">
    <a href="index.html" class="back-btn">â† Home</a>
    <div class="ai-badge">
      <div class="ai-avatar">ğŸ¤–</div>
      <div class="ai-info">
        <h3>AI Assistant</h3>
        <div class="ai-status">
          <span class="status-dot"></span>
          <span id="aiStatus">Checking auth...</span>
        </div>
      </div>
    </div>
  </div>
  <div class="header-actions">
    <button class="icon-btn" id="clearChat">ğŸ—‘ï¸</button>
  </div>
</header>

<div class="chat-container">
  <main class="chat-area">
    <div class="messages-container" id="messagesContainer">
      <div class="empty-state" id="emptyState">
        <div class="empty-state-icon">ğŸ¤–</div>
        <h2>Hello!</h2>
        <p>Login to start chatting with the AI assistant.</p>
      </div>
    </div>

    <div class="input-area">
      <div class="input-wrapper">
        <textarea id="messageInput" placeholder="Login required..." disabled></textarea>
        <button class="send-btn" id="sendBtn" disabled>â¤</button>
      </div>
    </div>
  </main>
</div>

<div id="toast" class="toast"></div>

<!-- ================= FIREBASE + AI LOGIC ================= -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
import { getFirestore, collection, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

/* ğŸ” SAME FIREBASE CONFIG â€” UNCHANGED */
const firebaseConfig = {
  apiKey: "AIzaSyAos3HZUfo49pLQEIwGc2mOlrdErMI95J0",
  authDomain: "aadityajha00.firebaseapp.com",
  projectId: "aadityajha00",
  storageBucket: "aadityajha00.firebasestorage.app",
  messagingSenderId: "953486639095",
  appId: "1:953486639095:web:0e23e9a917c4b6fd27f8f2"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

/* UI */
const input = document.getElementById("messageInput");
const sendBtn = document.getElementById("sendBtn");
const messages = document.getElementById("messagesContainer");
const emptyState = document.getElementById("emptyState");
const statusText = document.getElementById("aiStatus");
const toast = document.getElementById("toast");

let currentUser = null;

/* Toast */
function showToast(msg){
  toast.textContent = msg;
  toast.classList.add("active");
  setTimeout(()=>toast.classList.remove("active"),3000);
}

/* Auth guard */
onAuthStateChanged(auth, user => {
  currentUser = user;
  if(user){
    statusText.textContent = "Online â€¢ " + (user.displayName || user.email);
    input.disabled = false;
    sendBtn.disabled = false;
    input.placeholder = "Ask me anything...";
  } else {
    statusText.textContent = "Login required";
    input.disabled = true;
    sendBtn.disabled = true;
    input.placeholder = "Please login first";
  }
});

/* Send message */
sendBtn.addEventListener("click", sendMessage);
input.addEventListener("keydown", e=>{
  if(e.key==="Enter"){
    e.preventDefault();
    sendMessage();
  }
});

async function sendMessage(){
  const text = input.value.trim();
  if(!text || !currentUser) return;

  emptyState.style.display="none";
  addMessage("user", text);
  input.value="";

  showTyping();

  /* ğŸ”’ SAFE AI PLACEHOLDER */
  const aiReply = await fakeAIResponse(text, currentUser);

  removeTyping();
  addMessage("ai", aiReply);

  /* Save chat */
  await addDoc(collection(db,"aiChats"),{
    uid: currentUser.uid,
    email: currentUser.email,
    prompt: text,
    response: aiReply,
    createdAt: serverTimestamp()
  });
}

/* Messages */
function addMessage(sender, text){
  const el = document.createElement("div");
  el.className = "message " + sender;
  el.innerHTML = `
    <div class="message-avatar">${sender==="ai"?"ğŸ¤–":"ğŸ‘¤"}</div>
    <div class="message-content">
      <div class="message-text">${text}</div>
    </div>`;
  messages.appendChild(el);
  messages.scrollTop = messages.scrollHeight;
}

/* Typing */
function showTyping(){
  const t = document.createElement("div");
  t.id="typing";
  t.className="message ai";
  t.innerHTML=`<div class="message-avatar">ğŸ¤–</div><div class="message-content">Typing...</div>`;
  messages.appendChild(t);
  messages.scrollTop = messages.scrollHeight;
}
function removeTyping(){
  document.getElementById("typing")?.remove();
}

/* ğŸ” TEMP AI LOGIC (SAFE) */
async function fakeAIResponse(text,user){
  await new Promise(r=>setTimeout(r,1000));
  return `Hi ${user.displayName || "there"} ğŸ‘‹  
You said: "${text}"

I'm an AI assistant on Aaditya Jha's website.
This demo is frontend-safe.

ğŸš€ Real AI (OpenAI / Claude / Gemini) can be added using Firebase Functions.`;
}
</script>

</body>
</html>
